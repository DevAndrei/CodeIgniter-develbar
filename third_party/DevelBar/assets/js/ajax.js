CIjs=function(){"use strict";var n,a=function(a,b){return a.className.match(new RegExp("\\b"+b+"\\b"))},b=function(a,b){a.className=a.className.replace(new RegExp("\\b"+b+"\\b")," ")},c=function(b,c){a(b,c)||(b.className+=" "+c)},d=function(d,e){a(d,e)?b(d,e):c(d,e)},e=function(){},f=function(a,b,c,d,g){var h=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");g=g||{},g.maxTries=g.maxTries||0,h.open(g.method||"GET",a,!0),h.setRequestHeader("X-Requested-With","XMLHttpRequest"),h.onreadystatechange=function(i){return 4!==h.readyState?null:404==h.status&&g.maxTries>1?(setTimeout(function(){g.maxTries--,f(a,b,c,d,g)},500),null):void(200===h.status?(b||e)(h):(c||e)(h))},h.send(d||"")},g=[],h=function(a,b){var d,c=a.getAllResponseHeaders();(d=c.match(/^x-debug-token:\s+(.*)$/im))&&(b.profile=d[1]),(d=c.match(/^x-debug-token-link:\s+(.*)$/im))&&(b.profilerUrl=d[1])},i=4,j=0,k=function(){var a=document.querySelector(".ci-toolbar-ajax-requests");if(a){a.textContent="("+g.length+")",a.className="ci-toolbar-ajax-requests";var d=document.querySelector(".ci-toolbar-ajax-info");d&&(d.textContent=g.length+" AJAX request"+(g.length>1?"s":""));var e=document.querySelector(".ci-toolbar-block-ajax");g.length?c(e.parentNode,"active"):b(e.parentNode,"active"),j>0?c(e,"ci-ajax-request-loading"):i<4?(c(e,"ci-toolbar-status-red"),b(e,"ci-ajax-request-loading")):(b(e,"ci-ajax-request-loading"),b(e,"ci-toolbar-status-red"))}},l=function(a){var b=g[a];j++;var c=document.createElement("tr");b.DOMNode=c;var d=document.querySelector(".ci-toolbar-ajax-request-list");if(d){var e=document.createElement("td");e.textContent=b.method,c.appendChild(e);var f=document.createElement("td");f.textContent=b.type,c.appendChild(f);var h=document.createElement("td"),i=document.createElement("span");i.textContent="-",h.appendChild(i),c.appendChild(h);var l=document.createElement("td");if(l.className="ci-ajax-request-url","GET"===b.method){var m=document.createElement("a");m.setAttribute("href",b.url),m.setAttribute("target","_blank"),m.textContent=b.url,l.appendChild(m)}else l.textContent=b.url;l.setAttribute("title",b.url),c.appendChild(l);var n=document.createElement("td");n.className="ci-ajax-request-duration",n.textContent="-",c.appendChild(n),c.className="ci-ajax-request ci-ajax-request-loading",d.insertBefore(c,d.firstChild),k()}},m=function(a){var b=g[a];j--;var c=b.DOMNode,d=c.children[0],e=c.children[2],f=e.children[0],h=c.children[4],l=c.children[5];if(b.error?(c.className="ci-ajax-request ci-ajax-request-error",d.className="ci-ajax-request-error",i=0):(c.className="ci-ajax-request ci-ajax-request-ok",i++),b.statusCode&&(b.statusCode<300?f.setAttribute("class","ci-toolbar-status"):b.statusCode<400?f.setAttribute("class","ci-toolbar-status ci-toolbar-status-yellow"):f.setAttribute("class","ci-toolbar-status ci-toolbar-status-red"),f.textContent=b.statusCode),b.duration&&(h.textContent=b.duration+"ms"),b.profilerUrl){l.textContent="";var m=document.createElement("a");m.setAttribute("href",b.profilerUrl),m.textContent=b.profile,l.appendChild(m)}k()},o=document.createElement("div");if(n="addEventListener"in o?function(a,b,c){a.addEventListener(b,c,!1)}:function(a,b,c){a.attachEvent("on"+b,c)},window.fetch&&void 0===window.fetch.polyfill){var p=window.fetch;window.fetch=function(){var a=p.apply(this,arguments),b=arguments[0],c=arguments[1],d=Object.prototype.toString.call(arguments[0]);"[object Request]"===d&&(b=arguments[0].url,c={method:arguments[0].method,credentials:arguments[0].credentials,headers:arguments[0].headers,mode:arguments[0].mode,redirect:arguments[0].redirect});var e="GET";c&&void 0!==c.method&&(e=c.method);var f={error:!1,url:b,method:e,type:"fetch",start:new Date},h=g.push(f)-1;return a.then(function(a){f.duration=new Date-f.start,f.error=a.status<200||a.status>=400,f.statusCode=a.status,m(h)},function(a){f.error=!0}),l(h),a}}if(window.XMLHttpRequest&&XMLHttpRequest.prototype.addEventListener){var q=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(a,b,c,d,e){var f=this,j={error:!1,url:b,method:a,type:"xhr",start:new Date},k=g.push(j)-1;this.addEventListener("readystatechange",function(){4==f.readyState&&(j.duration=new Date-j.start,j.error=f.status<200||f.status>=400,j.statusCode=f.status,h(f,j),m(k))},!1),l(k),q.apply(this,Array.prototype.slice.call(arguments))}}return{hasClass:a,removeClass:b,addClass:c,toggleClass:d,addEventListener:n,request:f,renderAjaxRequests:k,load:function(a,c,d,g,h){var i=document.getElementById(a);return i&&i.getAttribute("data-ciurl")!==c&&f(c,function(a){i.innerHTML=a.responseText,i.setAttribute("data-ciurl",c),b(i,"loading"),(d||e)(a,i)},function(a){(g||e)(a,i)},"",h),this},toggle:function(a,b,c){var d=b.style.display,e=document.getElementById(a);return b.style.display=c.style.display,c.style.display=d,e&&(e.style.display="none"===d?"none":"block"),this}}}(),CIjs.addEventListener(window,"load",function(){CIjs.renderAjaxRequests()});